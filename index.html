<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Earnings Timer ‚Äî Neon Build</title>

<!-- üîÑ Force fresh load -->
<script>
(function(){
  const APP_VERSION = "24"; /* blocker update */
  const KEY = "ver_guard_seen";
  try {
    const url  = new URL(location.href);
    const curr = url.searchParams.get("v");
    const seen = sessionStorage.getItem(KEY);
    if (curr !== APP_VERSION) {
      if (seen !== APP_VERSION) {
        sessionStorage.setItem(KEY, APP_VERSION);
        url.searchParams.set("v", APP_VERSION);
        location.replace(url.toString());
      }
    }
  } catch (e) {}
})();
</script>

<style>
  :root{
    --bg:#0b1020; --panel:#111931; --panel-2:#0f172a; --text:#f8fafc; --muted:#94a3b8;
    --green:#22c55e; --green-2:#16a34a; --cyan:#22d3ee; --blue:#60a5fa; --purple:#a78bfa; --amber:#f59e0b; --red:#ef4444;
    --glow-soft: 0 0 12px rgba(34,197,94,.35), 0 0 24px rgba(34,197,94,.2);
    --glow-cyan: 0 0 12px rgba(34,211,238,.35), 0 0 24px rgba(34,211,238,.2);
    --glow-purple: 0 0 12px rgba(167,139,250,.35), 0 0 24px rgba(167,139,250,.2);
  }
  *{box-sizing:border-box}
  body{
    font-family:Inter,system-ui,Arial,sans-serif;
    background:radial-gradient(1200px 800px at 20% 10%, #0c1534 0%, #0b1020 40%, #070c19 100%);
    color:var(--text);
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    height:100vh;margin:0;overflow:hidden
  }
  .top{position:absolute;top:20px;left:20px;display:flex;align-items:center;gap:8px;z-index:5}
  .rate-wrap{display:flex;align-items:center;gap:8px;background:linear-gradient(180deg,#1a2547,#121a35);border:1px solid #334155;border-radius:10px;padding:6px 8px;box-shadow:0 6px 18px rgba(0,0,0,.25)}
  input[type="number"]{width:110px;padding:6px 6px;border:none;outline:none;font-size:16px;text-align:right;background:transparent;color:var(--text)}
  .timer{font-size:3rem;margin-bottom:6px;text-shadow:0 0 12px rgba(96,165,250,.25)}
  .amount{font-size:3rem;color:var(--green);margin-bottom:10px;text-shadow:0 0 16px rgba(34,197,94,.4)}
  .break-timer{font-size:1.15rem;color:var(--red);margin-bottom:8px;display:none;text-shadow:0 0 12px rgba(239,68,68,.4)}
  .break-timer.show{display:block}
  .break-summary{font-size:.95rem;color:#eab308;background:linear-gradient(180deg,#3b3a1b,#2b2a12);border:1px solid #534f1a;padding:6px 10px;border-radius:999px;display:none;margin-bottom:10px;box-shadow:0 8px 18px rgba(0,0,0,.25)}
  .break-summary.show{display:inline-block}
  .buttons{display:flex;gap:10px;margin-bottom:10px}
  .buttons2{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;width:min(460px,90vw)}
  .buttons2 button{width:100%}
  button{background:linear-gradient(180deg,#27457e,#1a2f59);border:1px solid #314978;color:#fff;padding:12px 24px;border-radius:12px;font-size:16px;cursor:pointer;box-shadow:0 8px 20px rgba(0,0,0,.25);transition:transform .06s ease, box-shadow .12s ease, filter .12s ease}
  button:active{transform:translateY(1px);filter:brightness(.95)}
  #start{background:linear-gradient(180deg,#1f9b4a,#137a38);border-color:#198e41;box-shadow:0 10px 24px rgba(0,0,0,.25), 0 0 24px rgba(34,197,94,.25)}
  #stop{background:linear-gradient(180deg,#b91c1c,#7f1d1d);border-color:#991b1b}
  #clear{background:linear-gradient(180deg,#475569,#334155);border-color:#475569}

  #historyBtn,#statsBtn{position:fixed;bottom:20px;background:linear-gradient(180deg,#17233f,#0f1a35);color:#fff;border:1px solid #2a3a64;border-radius:30px;padding:12px 18px;font-size:16px;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:background .2s, box-shadow .2s;z-index:25}
  #historyBtn:hover,#statsBtn:hover{background:#1b2a52}
  #historyBtn{left:50%;transform:translateX(-50%)}
  #historyBtn.flash{background:#14532d !important;box-shadow:0 0 0 6px rgba(34,197,94,.25)}
  .book{width:18px;height:18px;fill:#eab308}
  #statsBtn{right:20px;box-shadow:var(--glow-soft)}
  #statsBtn svg{width:20px;height:20px}
  #statsBtn path{stroke:var(--green)}
  #menuBtn{position:fixed;bottom:20px;left:20px;background:linear-gradient(180deg,#17233f,#0f1a35);color:#fff;border:1px solid #2a3a64;border-radius:30px;padding:12px 18px;font-size:16px;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:background .2s, box-shadow .2s;z-index:25}
  #menuBtn:hover{background:#1b2a52}
  .hamburger svg{width:18px;height:18px}

  #menuPanel{position:fixed;top:0;left:-75%;width:75%;height:100%;max-width:420px;background:linear-gradient(180deg,#0e172d,#0a1326);border-right:2px solid #2b3f6f;border-radius:0 12px 12px 0;transition:left .3s;display:flex;flex-direction:column;z-index:30;box-shadow:0 0 40px rgba(0,0,0,.45)}
  #menuPanel.show{left:0}
  #menuHeader{background:#0b1224;padding:12px 16px;border-radius:0 12px 0 0;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #2b3f6f}
  #menuHeader .title{display:inline-flex;align-items:center;gap:8px}
  #menuHeader h3{margin:0;font-size:18px}
  #closeMenu{background:#dc2626;border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:14px}
  #menuContent{padding:12px 16px;display:flex;flex-direction:column;gap:10px}
  .menu-item{background:linear-gradient(180deg,#0f1a34,#0b1224);border:1px solid #2a3a64;border-radius:12px;padding:12px 14px;font-size:15px;color:#e2e8f0;display:flex;justify-content:space-between;align-items:center;cursor:pointer;box-shadow:0 8px 18px rgba(0,0,0,.25)}
  .menu-item .r{opacity:.7}
  #settingsBtnFloat{position:absolute;right:20px;bottom:20px;background:#0ea5e9;border:1px solid #0284c7;color:#0b1020;border-radius:10px;padding:10px 14px;font-size:14px;cursor:pointer;box-shadow:var(--glow-cyan)}
  #settingsBtnFloat:hover{filter:brightness(1.05)}

  #goalsPanel{position:fixed;inset:0;background:radial-gradient(1200px 800px at 80% 0%, #0e1b3a 0%, #0b1224 50%, #09101f 100%);display:none;flex-direction:column;z-index:40}
  #goalsPanel.show{display:flex}
  #goalsHeader{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #2b3f6f;background:#0b1224}
  #goalsHeader h3{margin:0;font-size:18px}
  #goalsClose{background:#64748b;border:none;color:#fff;border-radius:8px;padding:8px 12px;font-size:14px;cursor:pointer}
  #goalsBody{padding:12px 16px;display:flex;flex-direction:column;gap:16px;overflow:auto;flex:1}
  .goal-card{background:linear-gradient(180deg,#0f172a,#0c1426);border:1px solid #2b3f6f;border-radius:14px;padding:14px;box-shadow:0 12px 24px rgba(0,0,0,.28)}
  .goal-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .goal-title{font-weight:800}
  .goal-values{font-size:13px;color:var(--muted)}
  .goal-bar{height:18px;background:linear-gradient(180deg,#0a1326,#0c1833);border:1px solid #23345e;border-radius:999px;overflow:hidden;position:relative;box-shadow:inset 0 0 0 1px rgba(255,255,255,0.04)}
  .goal-fill{
    height:100%;width:0%;
    background:
      radial-gradient(18px 12px at 20% 50%, rgba(255,255,255,.25), rgba(255,255,255,0) 70%) repeat-x,
      radial-gradient(18px 12px at 60% 50%, rgba(255,255,255,.2),  rgba(255,255,255,0) 70%) repeat-x,
      linear-gradient(90deg,#0ea75a 0%,#22c55e 40%,#86efac 100%);
    background-size: 60px 100%, 90px 100%, auto;
    background-position: var(--wave1,0px) 0, var(--wave2,0px) 0, 0 0;
    filter:saturate(1.25);
    box-shadow:0 0 18px rgba(34,197,94,.55),0 0 38px rgba(34,197,94,.28),inset 0 0 10px rgba(255,255,255,.12);
    transition:width .05s linear;position:relative;will-change:width,background-position;
  }
  .goal-fill::after{
    content:"";position:absolute;top:-60%;bottom:-60%;width:100px;left:-100px;
    background:radial-gradient(60px 140px at 0% 50%, rgba(255,255,255,.35), rgba(255,255,255,0) 70%);
    mix-blend-mode:screen;filter:blur(.5px);animation:shimmer 1.6s ease-in-out infinite;
  }
  @keyframes shimmer{0%{left:-100px;opacity:0}30%{opacity:.5}60%{left:20px;opacity:.25}100%{left:140px;opacity:0}}
  .goal-fill[data-pct="90"],.goal-fill[data-pct="91"],.goal-fill[data-pct="92"],.goal-fill[data-pct="93"],.goal-fill[data-pct="94"],.goal-fill[data-pct="95"],.goal-fill[data-pct="96"],.goal-fill[data-pct="97"],.goal-fill[data-pct="98"],.goal-fill[data-pct="99"],.goal-fill[data-pct="100"]{animation:nearDonePulse 1.2s ease-in-out infinite;}
  @keyframes nearDonePulse{0%,100%{filter:brightness(1)}50%{filter:brightness(1.25)}}
  .goal-edit{display:flex;align-items:center;gap:8px;margin-top:10px}
  .goal-edit label{font-size:13px;color:var(--muted)}
  .goal-edit input{flex:1;background:#0b1224;border:1px solid #2b3f6f;border-radius:10px;padding:10px 12px;color:var(--text)}
  .goal-edit button{background:linear-gradient(180deg,#22c55e,#13a24a);border:1px solid #15803d;color:#05210f;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer;box-shadow:var(--glow-soft)}

  #historyPanel{position:fixed;bottom:-75%;left:0;width:100%;max-height:75%;background:linear-gradient(180deg,#0f172a,#0b1224);color:var(--text);border-top:2px solid #2b3f6f;border-radius:12px 12px 0 0;padding:0;transition:bottom .3s;display:flex;flex-direction:column;z-index:40;box-shadow:0 -8px 28px rgba(0,0,0,.4)}
  #historyPanel.show{bottom:0}
  #historyHeader{background:#0b1224;padding:12px 16px;border-radius:12px 12px 0 0;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #2b3f6f}
  #historyHeader .title{display:inline-flex;align-items:center;gap:8px}
  #historyHeader h3{margin:0;font-size:18px}
  #closeHistory{background:#dc2626;border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:14px}
  #totals{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:12px 16px;border-bottom:1px solid #2b3f6f}
  .card{background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px}
  .card .k{font-size:12px;color:var(--muted)}
  .card .v{font-size:18px;font-weight:800;color:var(--green);text-shadow:0 0 12px rgba(34,197,94,.35)}
  #historyList{list-style:none;padding:12px 16px;margin:0;overflow-y:auto;flex-grow:1}
  #historyList li{background:linear-gradient(180deg,#0f172a,#101b36);border:1px solid #2b3f6f;border-radius:12px;padding:10px 12px;margin-bottom:10px;display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;box-shadow:0 8px 18px rgba(0,0,0,.25)}
  .meta{font-size:13px;color:var(--muted);margin-bottom:6px}
  .dur{font-size:15px;font-weight:bold}
  .amt{color:var(--green);font-weight:bold;font-size:16px;text-shadow:0 0 12px rgba(34,197,94,.35)}
  .tag{display:inline-block;margin-top:6px;font-size:12px;color:#eab308;background:#3b3a1b;border:1px solid #534f1a;padding:2px 6px;border-radius:999px}
  .row-actions{display:flex;flex-direction:column;gap:6px}
  .btn-small{background:#1a274a;border:1px solid #2a3a64;color:#fff;padding:6px 10px;border-radius:8px;font-size:13px;cursor:pointer}
  .btn-danger{background:#7f1d1d;border-color:#b91c1c}
  .btn-export{background:#0ea5e9;border-color:#0284c7;box-shadow:var(--glow-cyan)}

  .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:50;opacity:0;transition:opacity .25s ease}
  .backdrop.show{display:flex;opacity:1}
  .modal{background:linear-gradient(180deg,#0f172a,#0c1427);border:1px solid #2b3f6f;border-radius:14px;padding:16px;width:340px;max-width:92vw;box-shadow:0 12px 32px rgba(0,0,0,.45)}
  .modal h3{margin:0 0 10px;text-align:center}
  .field{display:flex;align-items:center;gap:8px;background:#0b1224;border:1px solid #2b3f6f;border-radius:10px;padding:8px 10px;margin-top:8px}
  .actions{display:flex;gap:10px;margin-top:14px}
  .actions button{flex:1;padding:10px;border:none;border-radius:10px;font-weight:bold;cursor:pointer}
  #discardBtn{background:#6b7280} #saveBtn{background:#22c55e}
  input[type="datetime-local"]{background:transparent;border:none;outline:none;color:var(--text)}
  #editCancel{background:#6b7280} #editSave{background:#22c55e}
  #confirmYes{background:#dc2626} #confirmNo{background:#6b7280}
  .setting-row{display:flex;align-items:center;justify-content:space-between;background:#0f172a;border:1px solid #2b3f6f;border-radius:10px;padding:10px 12px;margin-top:10px}

  #statsBackdrop{position:fixed;inset:0;background:rgba(3,6,14,.75);display:none;align-items:center;justify-content:center;z-index:50;opacity:0;transition:opacity .25s ease}
  #statsBackdrop.show{display:flex;opacity:1}
  #statsModal{background:linear-gradient(180deg,#0f172a,#0c1426);border:1px solid #2b3f6f;border-radius:18px;padding:20px;width:95%;max-width:820px;max-height:90vh;overflow-y:auto;box-shadow:0 40px 80px rgba(0,0,0,.5)}
  .stats-header{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #2b3f6f;padding-bottom:8px;margin-bottom:12px}
  .stats-header h3{margin:0;font-size:20px}
  .stats-close{background:#22c55e;border:none;color:#0f172a;padding:8px 12px;border-radius:8px;font-weight:bold;cursor:pointer}
  .stat-summary{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:12px}
  .stat-card{background:radial-gradient(200px 120px at 70% -20%, rgba(34,211,238,.18), transparent 60%), linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px;box-shadow:0 16px 28px rgba(0,0,0,.35)}
  .stat-title{font-size:13px;color:var(--muted)}
  .stat-value{font-size:22px;font-weight:800;color:var(--green);text-shadow:0 0 16px rgba(34,197,94,.5)}
  .stat-card:nth-child(2) .stat-value{color:var(--cyan);text-shadow:0 0 16px rgba(34,211,238,.45)}
  .stat-card:nth-child(3) .stat-value{color:var(--purple);text-shadow:0 0 16px rgba(167,139,250,.45)}
  canvas{background:linear-gradient(180deg,#0b1224,#0f172a);border:1px solid #2b3f6f;border-radius:14px;margin-bottom:14px;box-shadow:0 12px 28px rgba(0,0,0,.35), 0 0 24px rgba(96,165,250,.15)}

  /* ‚¨áÔ∏è Repurposed from ‚ÄúBreak Analytics‚Äù ‚Üí Tag Effectiveness */
  .break-section{margin:12px 0 16px 0;background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:14px;padding:14px;box-shadow:0 0 15px rgba(34,197,94,.2)}
  .break-title{font-size:18px;font-weight:800;color:var(--green);text-align:center;margin:0 0 8px 0;text-shadow:0 0 12px rgba(34,197,94,.5);letter-spacing:.3px}
  .break-summary{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:10px;text-align:center}
  .break-summary div{background:#0f172a;border:1px solid #2b3f6f;border-radius:12px;padding:10px;box-shadow:0 0 10px rgba(34,197,94,.18)}
  .break-summary span{display:block;color:var(--green);font-weight:800;font-size:16px;margin-top:4px}

  body.light{background:#f5f7fb;color:#0f172a}
  body.light .stat-card, body.light #statsModal, body.light .goal-card, body.light .modal, body.light #historyPanel, body.light .menu-item{background:#ffffff;border-color:#e5e7eb}
  body.light #historyList li{background:#ffffff;border-color:#e5e7eb}
  body.light .field{background:#ffffff;border-color:#e5e7eb}
  body.light .goal-bar{background:#eef2ff;border-color:#c7d2fe}

  #inboxBtn{position:fixed;top:20px;right:20px;background:linear-gradient(180deg,#17233f,#0f1a35);color:#fff;border:1px solid #2a3a64;border-radius:20px;padding:10px 14px;font-size:14px;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:background .2s;z-index:35}
  #inboxBtn:hover{background:#1b2a52}
  #inboxBtn svg{width:18px;height:18px}
  #inboxPanel{position:fixed;top:0;right:-75%;width:75%;max-width:420px;height:100%;background:linear-gradient(180deg,#0e172d,#0a1326);border-left:2px solid #2b3f6f;border-radius:12px 0 0 12px;transition:right .3s;display:flex;flex-direction:column;z-index:45}
  #inboxPanel.show{right:0}
  #inboxHeader{background:#0b1224;padding:12px 16px;border-bottom:1px solid #2b3f6f;display:flex;justify-content:space-between;align-items:center;border-radius:12px 0 0 0}
  #inboxHeader h3{margin:0;font-size:18px}
  #closeInbox{background:#64748b;border:none;color:#fff;border-radius:8px;padding:8px 12px;font-size:14px;cursor:pointer}
  #inboxBody{flex:1;display:flex;align-items:center;justify-content:center;padding:16px}
  .inbox-empty{color:#94a3b8;font-size:15px;opacity:.9;text-align:center;background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:14px 18px;box-shadow:0 12px 24px rgba(0,0,0,.28)}

  #expensesPanel{position:fixed;top:0;right:-75%;width:75%;max-width:520px;height:100%;background:linear-gradient(180deg,#0e172d,#0a1326);border-left:2px solid #2b3f6f;border-radius:12px 0 0 12px;transition:right .3s;display:flex;flex-direction:column;z-index:46;box-shadow:0 0 40px rgba(0,0,0,.45)}
  #expensesPanel.show{right:0}
  #expensesHeader{background:#0b1224;padding:12px 16px;border-bottom:1px solid #2b3f6f;display:flex;align-items:center;justify-content:space-between;border-radius:12px 0 0 0}
  #expensesHeader h3{margin:0;font-size:18px}
  #closeExpenses{background:#64748b;border:none;color:#fff;border-radius:8px;padding:8px 12px;font-size:14px;cursor:pointer}
  #expensesBody{flex:1;overflow:auto;padding:12px 16px;display:flex;flex-direction:column;gap:12px}
  .xp-form{display:grid;grid-template-columns:1fr 1fr;gap:10px;background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px}
  .xp-form .full{grid-column:1/-1}
  .xp-form label{font-size:12px;color:var(--muted)}
  .xp-form input,.xp-form select,.xp-form textarea{width:100%;background:#0b1224;border:1px solid #2b3f6f;border-radius:10px;padding:10px 12px;color:var(--text)}
  .xp-form textarea{min-height:64px;resize:vertical}
  .xp-actions{display:flex;gap:10px}
  .xp-primary{background:#22c55e;border:1px solid #15803d;color:#05210f;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer;box-shadow:var(--glow-soft)}
  .xp-secondary{background:#0ea5e9;border:1px solid #0284c7;border-radius:10px;padding:10px 12px;cursor:pointer;box-shadow:var(--glow-cyan)}
  .xp-cards{display:flex;gap:10px}
  .xp-card{flex:1;background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px}
  .xp-card .k{font-size:12px;color:var(--muted)}
  .xp-card .v{font-size:18px;font-weight:800}
  .xp-list{background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px}
  .xp-item{display:grid;grid-template-columns:1fr auto;gap:8px;padding:10px;border:1px solid #2b3f6f;border-radius:10px;margin-bottom:8px}
  .xp-item .m{font-weight:700}
  .xp-item .c{font-size:12px;color:var(--muted)}
  .xp-item .amt{font-weight:800;color:#ef4444}
  .xp-row-actions{display:flex;gap:6px}
  .btn-mini{background:#1a274a;border:1px solid #2a3a64;border-radius:8px;padding:6px 10px;font-size:12px;cursor:pointer}
  .btn-mini.danger{background:#7f1d1d;border-color:#b91c1c}
  .btn-mini.edit{background:#15803d;border-color:#166534}
  .xp-chart{background:linear-gradient(180deg,#0f172a,#0b1224);border:1px solid #2b3f6f;border-radius:12px;padding:12px}
  .xp-note{font-size:12px;color:var(--muted)}
  .budget-ok{color:#22c55e} .budget-warn{color:#f59e0b} .budget-bad{color:#ef4444}

  /* üîí Global blocker to disable background when any overlay is open */
  #globalBlocker{position:fixed; inset:0; background:transparent; display:none; z-index:19; pointer-events:auto;}
</style>
</head>
<body>

<!-- üîí Invisible glass pane that intercepts clicks when overlays are open -->
<div id="globalBlocker" aria-hidden="true"></div>

<div class="top">
  <span>Amount ($/hr):</span>
  <div class="rate-wrap"><input id="rate" type="number" value="25" step="0.01" min="0"></div>
</div>

<div class="timer" id="timeDisplay">00:00:00.00</div>
<div class="amount" id="moneyDisplay">$0.00</div>
<div class="break-timer" id="breakDisplay">Break: 00:00:00</div>
<div class="break-summary" id="breakSummary"></div>

<div class="buttons">
  <button id="start">Start</button>
  <button id="stop">Stop</button>
  <button id="clear">Clear</button>
</div>

<div class="buttons2">
  <button id="startAtBtn">Start At</button>
  <button id="stopAtBtn">Stop At</button>
  <button id="takeBreakBtn">Take Break</button>
  <button id="endBreakBtn">End Break</button>
</div>

<button id="menuBtn" aria-controls="menuPanel" aria-expanded="false">
  <span class="hamburger" aria-hidden="true">
    <svg viewBox="0 0 24 24" fill="none" stroke="#e5e7eb" stroke-width="2" stroke-linecap="round">
      <path d="M4 7h16"></path><path d="M4 12h16"></path><path d="M4 17h16"></path>
    </svg>
  </span>
  Menu
</button>

<button id="historyBtn" aria-live="polite">
  <svg class="book" viewBox="0 0 24 24" aria-hidden="true">
    <path d="M4 4.5A2.5 2.5 0 0 1 6.5 2H20v18H6.5A2.5 2.5 0 0 0 4 22V4.5zM6.5 4A.5.5 0 0 0 6 4.5v15a.5.5 0 0 0 .5.5H18V4H6.5z"/>
  </svg>
  History
</button>

<button id="statsBtn" title="View Stats">
  <svg viewBox="0 0 24 24" aria-hidden="true">
    <path d="M4 21h16M6 17V9m4 8V5m4 12v-7m4 7V3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  Stats
</button>

<button id="inboxBtn" aria-controls="inboxPanel" aria-expanded="false" title="Inbox">
  <svg viewBox="0 0 24 24" fill="none" stroke="#e5e7eb" stroke-width="2" stroke-linecap="round">
    <path d="M4 5h16v14H4z"></path><path d="M22 6l-10 7L2 6"></path>
  </svg>
  Inbox
</button>

















<div id="menuPanel" aria-hidden="true" role="dialog" aria-labelledby="menuTitle">
  <div id="menuHeader">
    <div class="title">
      <span class="hamburger" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="#e5e7eb" stroke-width="2" stroke-linecap="round">
          <path d="M4 7h16"></path><path d="M4 12h16"></path><path d="M4 17h16"></path>
        </svg>
      </span>
      <h3 id="menuTitle">Menu</h3>
    </div>
    <button id="closeMenu">Close</button>
  </div>
  <div id="menuContent">
    <div class="menu-item" id="menuGoals"><span>Goals</span><span class="r">‚Ä∫</span></div>
    <div class="menu-item" id="menuSummary"><span>Summary</span><span class="r">‚Ä∫</span></div>
    <div class="menu-item" id="menuCalc"><span>Calculator</span><span class="r">‚Ä∫</span></div>
    <div class="menu-item" id="menuExpenses"><span>Expenses</span><span class="r">‚Ä∫</span></div>
  </div>
  <button id="settingsBtnFloat" aria-controls="settingsBackdrop">Settings</button>
</div>

<div id="goalsPanel" aria-hidden="true" role="dialog" aria-labelledby="goalsTitle">
  <div id="goalsHeader">
    <h3 id="goalsTitle">Goals</h3>
    <button id="goalsClose">Back</button>
  </div>
  <div id="goalsBody">
    <div class="goal-card">
      <div class="goal-top"><div class="goal-title">Yearly Target</div><div class="goal-values" id="yearlyValues">$0 / $0 (0%)</div></div>
      <div class="goal-bar"><div id="yearlyBar" class="goal-fill"></div></div>
      <div class="goal-edit"><label for="yearlyInput">Set target</label><input id="yearlyInput" type="number" min="0" step="0.01" placeholder="e.g. 50000"><button id="yearlySave">Save</button></div>
    </div>
    <div class="goal-card">
      <div class="goal-top"><div class="goal-title">Monthly Target</div><div class="goal-values" id="monthlyValues">$0 / $0 (0%)</div></div>
      <div class="goal-bar"><div id="monthlyBar" class="goal-fill"></div></div>
      <div class="goal-edit"><label for="monthlyInput">Set target</label><input id="monthlyInput" type="number" min="0" step="0.01" placeholder="e.g. 4000"><button id="monthlySave">Save</button></div>
    </div>
    <div class="goal-card">
      <div class="goal-top"><div class="goal-title">Weekly Target</div><div class="goal-values" id="weeklyValues">$0 / $0 (0%)</div></div>
      <div class="goal-bar"><div id="weeklyBar" class="goal-fill"></div></div>
      <div class="goal-edit"><label for="weeklyInput">Set target</label><input id="weeklyInput" type="number" min="0" step="0.01" placeholder="e.g. 1000"><button id="weeklySave">Save</button></div>
    </div>
    <div class="goal-card">
      <div class="goal-top"><div class="goal-title">Daily Target</div><div class="goal-values" id="dailyValues">$0 / $0 (0%)</div></div>
      <div class="goal-bar"><div id="dailyBar" class="goal-fill"></div></div>
      <div class="goal-edit"><label for="dailyInput">Set target</label><input id="dailyInput" type="number" min="0" step="0.01" placeholder="e.g. 200"><button id="dailySave">Save</button></div>
    </div>
  </div>
</div>

<div id="historyPanel" aria-hidden="true">
  <div id="historyHeader">
    <div class="title">
      <svg class="book" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M4 4.5A2.5 2.5 0 0 1 6.5 2H20v18H6.5A2.5 2.5 0 0 0 4 22V4.5zM6.5 4A.5.5 0 0 0 6 4.5v15a.5.5 0 0 0 .5.5H18V4H6.5z"/>
      </svg>
      <h3>History</h3>
    </div>
    <button id="closeHistory">Close</button>
  </div>
  <div id="totals">
    <div class="card"><div class="k">This week</div><div class="v" id="weekTotal">$0.00</div></div>
    <div class="card"><div class="k">This month</div><div class="v" id="monthTotal">$0.00</div></div>
  </div>
  <ul id="historyList"></ul>
</div>

<div id="inboxPanel" aria-hidden="true" role="dialog" aria-labelledby="inboxTitle">
  <div id="inboxHeader"><h3 id="inboxTitle">Inbox</h3><button id="closeInbox">Close</button></div>
  <div id="inboxBody"><div class="inbox-empty">no messages</div></div>
</div>

<div id="expensesPanel" aria-hidden="true" role="dialog" aria-labelledby="expensesTitle">
  <div id="expensesHeader"><h3 id="expensesTitle">Expenses</h3><button id="closeExpenses">Close</button></div>
  <div id="expensesBody">
    <div class="xp-form">
      <div><label for="xpAmount">Amount</label><input id="xpAmount" type="number" step="0.01" min="0" placeholder="e.g. 14.99"></div>
      <div><label for="xpDate">Date</label><input id="xpDate" type="date"></div>
      <div><label for="xpMerchant">Merchant</label><input id="xpMerchant" type="text" placeholder="e.g. McDonald's"></div>
      <div><label for="xpCategory">Category</label>
        <select id="xpCategory">
          <option>Auto & Gas</option><option>Groceries</option><option>Restaurants</option><option>Bars & Nightlife</option>
          <option>Subscriptions</option><option>Shopping</option><option>Bills & Utilities</option><option>Healthcare</option>
          <option>Entertainment</option><option>Travel</option><option>Other</option>
        </select>
      </div>
      <div class="full"><label for="xpNote">Note</label><textarea id="xpNote" placeholder="Optional note"></textarea></div>
      <div class="full xp-actions">
        <button id="xpAddBtn" class="xp-primary">Add Expense</button>
        <button id="xpImportBtn" class="xp-secondary" title="Paste: 2025-10-08, Walmart, 42.11, Groceries">Quick Import</button>
        <button id="xpClearMonthBtn" class="btn-mini danger" style="margin-left:auto">Clear Current Month</button>
      </div>
    </div>

    <div class="xp-cards">
      <div class="xp-card"><div class="k">This Month</div><div class="v" id="xpMonthSpend">$0.00</div><div class="xp-note" id="xpBudgetHint">No budget set</div></div>
      <div class="xp-card"><div class="k">Top Category</div><div class="v" id="xpTopCat">‚Äî</div><div class="xp-note" id="xpTopCatShare">‚Äî</div></div>
    </div>

    <div class="xp-chart"><h4 style="margin:0 0 8px">Category Breakdown</h4><canvas id="xpPie" height="180"></canvas><div class="xp-note">Shows where the month‚Äôs money actually went.</div></div>
    <div class="xp-chart"><h4 style="margin:0 0 8px">Monthly Trend</h4><canvas id="xpTrend" height="180"></canvas><div class="xp-note">Last 6 months.</div></div>
    <div class="xp-list"><h4 style="margin:0 0 8px">Entries</h4><div id="xpList"></div></div>
    <div class="xp-list"><h4 style="margin:0 0 8px">Suggestions</h4><ul id="xpSuggestions" style="margin:0;padding-left:18px"></ul></div>
  </div>
</div>

<div id="saveBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="saveTitle">
  <div class="modal">
    <h3 id="saveTitle">Save this session?</h3>
    <div class="field"><span style="font-size:14px;color:#94a3b8;">Tag</span><input id="tagInput" type="text" placeholder="Optional tag"></div>
    <div class="actions"><button id="discardBtn">No</button><button id="saveBtn">Yes, Save</button></div>
  </div>
</div>

<div id="editBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="editTitle">
  <div class="modal">
    <h3 id="editTitle">Edit entry</h3>
    <div class="field"><label style="width:80px;color:#94a3b8">Start</label><input id="editStart" type="datetime-local"></div>
    <div class="field"><label style="width:80px;color:#94a3b8">End</label><input id="editEnd" type="datetime-local"></div>
    <div class="field"><span style="font-size:14px;color:#94a3b8;">Tag</span><input id="editTag" type="text" placeholder="Edit tag"></div>
    <div class="actions"><button id="editCancel">Cancel</button><button id="editSave">Save changes</button></div>
  </div>
</div>

<div id="confirmBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
  <div class="modal"><h3 id="confirmTitle">Delete this entry?</h3><div class="actions"><button id="confirmNo">No</button><button id="confirmYes">Yes</button></div></div>
</div>

<div id="settingsBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
  <div class="modal">
    <h3 id="settingsTitle">Settings</h3>
    <div class="setting-row"><div>Theme</div><div class="field" style="margin:0;"><select id="themeSelect" aria-label="Theme"><option value="dark">Dark</option><option value="light">Light</option></select></div></div>
    <div class="setting-row"><div>Sound</div><label class="switch"><input type="checkbox" id="soundToggle"><span class="slider"></span></label></div>
    <div class="setting-row"><div>Haptic feedback</div><label class="switch"><input type="checkbox" id="hapticsToggle"><span class="slider"></span></label></div>
    <div class="actions" style="margin-top:16px;"><button id="settingsClose" style="background:#6b7280;">Close</button><button id="settingsSave" style="background:#22c55e;">Save</button></div>
  </div>
</div>

<div id="startAtBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="startAtTitle">
  <div class="modal">
    <h3 id="startAtTitle">Start At</h3>
    <div class="field"><label style="width:90px;color:#94a3b8">Date/Time</label><input id="startAtInput" type="datetime-local"></div>
    <div class="actions"><button id="startAtCancel" style="background:#6b7280;">Cancel</button><button id="startAtSave" style="background:#22c55e;">Set</button></div>
  </div>
</div>

<div id="stopAtBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="stopAtTitle">
  <div class="modal">
    <h3 id="stopAtTitle">Stop At</h3>
    <div class="field"><label style="width:90px;color:#94a3b8">Date/Time</label><input id="stopAtInput" type="datetime-local"></div>
    <div class="actions"><button id="stopAtCancel" style="background:#6b7280;">Cancel</button><button id="stopAtSave" style="background:#22c55e;">Set</button></div>
  </div>
</div>

<div id="exportBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="exportTitle">
  <div class="modal"><h3 id="exportTitle">Export</h3><p style="text-align:center;margin:8px 0 0;">Coming soon.</p><div class="actions" style="margin-top:12px;"><button id="exportClose" style="background:#22c55e;">OK</button></div></div>
</div>

<div id="statsBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="statsTitle">
  <div id="statsModal">
    <div class="stats-header"><h3 id="statsTitle">Performance Dashboard</h3><button class="stats-close" id="statsClose">Close</button></div>
    <div class="stat-summary">
      <div class="stat-card"><div class="stat-title">Today</div><div class="stat-value" id="todayEarned">$0.00</div></div>
      <div class="stat-card"><div class="stat-title">This Week</div><div class="stat-value" id="weekEarned">$0.00</div></div>
      <div class="stat-card"><div class="stat-title">This Month</div><div class="stat-value" id="monthEarned">$0.00</div></div>
    </div>
    <canvas id="earningsChart" height="170"></canvas>
    <canvas id="hoursChart" height="170"></canvas>

    <!-- üîÅ Tag Effectiveness donut (7d) -->
    <div class="break-section">
      <p class="break-title">Tag Effectiveness (7d)</p>
      <canvas id="breakChart" height="200"></canvas>
      <div class="break-summary" style="margin-top:12px">
        <div>Top Tag<span id="topTag">‚Äî</span></div>
        <div>Unique Tags<span id="tagCount">0</span></div>
        <div>Top Share<span id="topShare">0%</span></div>
      </div>
    </div>

    <div class="analytics-info">
      <p>Average hourly rate: <span id="avgRate">$0/hr</span></p>
      <p>Average daily earnings (7d): <span id="avgDay">$0</span></p>
      <p>Trend insight: <span id="trend">Stable</span></p>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
  /* ========= State ========= */
  let startTime = 0, elapsed = 0, running = false, interval = null;
  let startWallTs = null, endWallTs = null;

  let history = [];
  let editingId = null;
  let pendingDeleteId = null;

  let scheduledStartTs = null;
  let scheduledStopTs = null;

  let onBreak = false;
  let breakStartTs = null;
  let breakTicker = null;
  let sessionBreakMs = 0;

  let prefs = { theme:'dark', sound:true, haptics:true };
  let goals = { yearly:0, monthly:0, weekly:0, daily:0 };

  let expenses = [];
  let budgets = {
    'Groceries': 600, 'Restaurants': 300, 'Bars & Nightlife': 150,
    'Subscriptions': 80, 'Shopping': 250, 'Bills & Utilities': 400,
    'Auto & Gas': 220, 'Healthcare': 120, 'Entertainment': 120,
    'Travel': 0, 'Other': 100
  };

  const STORE_KEY_STATE     = 'earningsTimer_state_v7';
  const STORE_KEY_HISTORY   = 'earningsTimer_history_v2';
  const STORE_KEY_PREFS     = 'earningsTimer_prefs_v1';
  const STORE_KEY_GOALS     = 'earningsTimer_goals_v1';
  const STORE_KEY_EXPENSES  = 'earningsTimer_expenses_v1';
  const STORE_KEY_BUDGETS   = 'earningsTimer_budgets_v1';

  /* ========= Elements ========= */
  const timeDisplay   = document.getElementById('timeDisplay');
  const moneyDisplay  = document.getElementById('moneyDisplay');
  const breakDisplay  = document.getElementById('breakDisplay');
  const breakSummary  = document.getElementById('breakSummary');

  const rateInput = document.getElementById('rate');
  const startBtn = document.getElementById('start');
  const stopBtn  = document.getElementById('stop');
  const clearBtn = document.getElementById('clear');

  const startAtBtn = document.getElementById('startAtBtn');
  const stopAtBtn  = document.getElementById('stopAtBtn');
  const takeBreakBtn = document.getElementById('takeBreakBtn');
  const endBreakBtn  = document.getElementById('endBreakBtn');

  const historyBtn   = document.getElementById('historyBtn');
  const historyPanel = document.getElementById('historyPanel');
  const closeHistory = document.getElementById('closeHistory');
  const historyList  = document.getElementById('historyList');
  const weekTotalEl  = document.getElementById('weekTotal');
  const monthTotalEl = document.getElementById('monthTotal');

  const saveBackdrop  = document.getElementById('saveBackdrop');
  const discardBtn    = document.getElementById('discardBtn');
  const saveBtn       = document.getElementById('saveBtn');
  const tagInput      = document.getElementById('tagInput');

  const editBackdrop = document.getElementById('editBackdrop');
  const editStart = document.getElementById('editStart');
  const editEnd   = document.getElementById('editEnd');
  const editTag   = document.getElementById('editTag');
  const editCancel= document.getElementById('editCancel');
  const editSave  = document.getElementById('editSave');

  const confirmBackdrop = document.getElementById('confirmBackdrop');
  const confirmYes = document.getElementById('confirmYes');
  const confirmNo  = document.getElementById('confirmNo');

  const menuBtn = document.getElementById('menuBtn');
  const menuPanel = document.getElementById('menuPanel');
  const closeMenu = document.getElementById('closeMenu');
  const settingsBtnFloat = document.getElementById('settingsBtnFloat');

  const menuGoals   = document.getElementById('menuGoals');
  const menuSummary = document.getElementById('menuSummary');
  const menuCalc    = document.getElementById('menuCalc');
  const menuExpenses= document.getElementById('menuExpenses');

  const settingsBackdrop = document.getElementById('settingsBackdrop');
  const settingsClose = document.getElementById('settingsClose');
  const settingsSave  = document.getElementById('settingsSave');
  const themeSelect = document.getElementById('themeSelect');
  const soundToggle = document.getElementById('soundToggle');
  const hapticsToggle = document.getElementById('hapticsToggle');

  const startAtBackdrop = document.getElementById('startAtBackdrop');
  const startAtInput    = document.getElementById('startAtInput');
  const startAtCancel   = document.getElementById('startAtCancel');
  const startAtSave     = document.getElementById('startAtSave');

  const stopAtBackdrop = document.getElementById('stopAtBackdrop');
  const stopAtInput    = document.getElementById('stopAtInput');
  const stopAtCancel   = document.getElementById('stopAtCancel');
  const stopAtSave     = document.getElementById('stopAtSave');

  const exportBackdrop = document.getElementById('exportBackdrop');
  const exportClose = document.getElementById('exportClose');

  const goalsPanel   = document.getElementById('goalsPanel');
  const goalsClose   = document.getElementById('goalsClose');
  const yearlyValues = document.getElementById('yearlyValues');
  const monthlyValues= document.getElementById('monthlyValues');
  const weeklyValues = document.getElementById('weeklyValues');
  const dailyValues  = document.getElementById('dailyValues');
  const yearlyBar = document.getElementById('yearlyBar');
  const monthlyBar= document.getElementById('monthlyBar');
  const weeklyBar = document.getElementById('weeklyBar');
  const dailyBar  = document.getElementById('dailyBar');
  const yearlyInput = document.getElementById('yearlyInput');
  const monthlyInput= document.getElementById('monthlyInput');
  const weeklyInput = document.getElementById('weeklyInput');
  const dailyInput  = document.getElementById('dailyInput');
  const yearlySave  = document.getElementById('yearlySave');
  const monthlySave = document.getElementById('monthlySave');
  const weeklySave  = document.getElementById('weeklySave');
  const dailySave   = document.getElementById('dailySave');

  const statsBtn = document.getElementById('statsBtn');
  const statsBackdrop = document.getElementById('statsBackdrop');
  const statsClose = document.getElementById('statsClose');
  const todayEarned = document.getElementById('todayEarned');
  const weekEarned = document.getElementById('weekEarned');
  const monthEarned = document.getElementById('monthEarned');
  const avgRateEl = document.getElementById('avgRate');
  const avgDayEl = document.getElementById('avgDay');
  const trendEl = document.getElementById('trend');

  const inboxBtn = document.getElementById('inboxBtn');
  const inboxPanel = document.getElementById('inboxPanel');
  const closeInbox = document.getElementById('closeInbox');

  const expensesPanel = document.getElementById('expensesPanel');
  const closeExpenses = document.getElementById('closeExpenses');
  const xpAmount = document.getElementById('xpAmount');
  const xpDate = document.getElementById('xpDate');
  const xpMerchant = document.getElementById('xpMerchant');
  const xpCategory = document.getElementById('xpCategory');
  const xpNote = document.getElementById('x